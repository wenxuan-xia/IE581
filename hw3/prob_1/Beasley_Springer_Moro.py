import u16807d
import numpy as np

def Beasley_Springer_Moro(seed):
    a0=2.50662823884;
    a1=-18.61500062529;
    a2=41.39119773534;
    a3=-25.44106049637;

    b0=-8.47351093090;
    b1=23.08336743743;
    b2=-21.06224101826;
    b3=3.13082909833;

    c0=0.3374754822726147;
    c1=0.9761690190917186;
    c2=0.1607979714918209;
    c3=0.0276438810333863;
    c4=0.0038405729373609;
    c5=0.0003951896511919;
    c6=0.0000321767881768;
    c7=0.0000002888167364;
    c8=0.0000003960315187;

    seed, u1 = u16807d.u16807d(seed)
    y = u1 - 0.5
    result = 0


    if (abs(y) < 0.42):
        r = y*y
        result = y * (a0 + r*(a1 + r*(a2 + r*a3))) / (1.0 + r*(b0 + r*(b1 + r*(b2 + r*b3))))
    else:
        if (y <= 0):
            r = u1
        else:
            r = 1 - u1
        # print r
        s = np.log( - np.log(r) )
        t = c0 + s*(c1 + s*(c2 + s*(c3 + s*(c4 + s*(c5 + s*(c6 + s*(c7+ s*c8)))))))

        if (u1>0.5):
            result = t
        else:
            result = -t

    return result, seed
